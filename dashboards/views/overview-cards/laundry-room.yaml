type: custom:bubble-card
card_type: button
button_type: name
name: Laundry Room
icon: mdi:washing-machine
show_state: false
show_last_changed: false
show_attribute: false
card_layout: large
sub_button:
- icon: mdi:washing-machine
  name: Washer
  show_state: false
  show_background: true
  show_icon: true
  tap_action:
    action: fire-dom-event
    browser_mod:
      service: browser_mod.popup
      data:
        title: "Laundry: Washer"
        content: !include ../../popup-content/laundry-washer.yaml
  styles: |-
    ${(() => {
      const st = hass.states['sensor.washer_current_status']?.state || 'unknown';
      const remRaw = hass.states['sensor.washer_remaining_time']?.state;
      const totRaw = hass.states['sensor.washer_total_time']?.state;
      const isNum = (v) => v !== undefined && v !== null && !isNaN(parseFloat(v));
      const rem = isNum(remRaw) ? parseFloat(remRaw) : NaN;
      const tot = isNum(totRaw) ? parseFloat(totRaw) : NaN;
      const progress = (!isNaN(rem) && !isNaN(tot) && tot > 0) ? Math.max(0, Math.min(1, rem / tot)) : 0;
      const s = (arr => arr.some(k => st.toLowerCase().includes(k)))(['run','running','wash','rinse','spin','tumble','on','start','pre']) && st.toLowerCase() !== 'power_off';
      const bg = s ? 'rgba(100, 181, 246, 0.25)' : 'rgba(120, 144, 156, 0.20)';
      let css = '';
      css += `.bubble-sub-button { border: 3px solid transparent; border-radius: 16px; background: linear-gradient(${bg}), conic-gradient(#2196F3 calc(${progress} * 360deg), rgba(33,150,243,0.12) 0) !important; background-clip: padding-box, border-box; ${s ? 'animation: jiggle 0.6s ease-in-out infinite alternate;' : ''} }`;
      css += `.bubble-sub-button-icon { --mdc-icon-size: 26px; color: ${s ? '#1565C0' : '#546E7A'} !important; }`;
      css += `.bubble-sub-button-name { color: ${s ? '#0D47A1' : '#37474F'} !important; }`;
      css += `@keyframes jiggle { from { transform: translateY(0px) rotate(-1deg); } to { transform: translateY(-1px) rotate(1deg); } }`;
      return css;
    })()}
- icon: mdi:tumble-dryer
  name: Dryer
  show_state: false
  show_background: true
  show_icon: true
  tap_action:
    action: fire-dom-event
    browser_mod:
      service: browser_mod.popup
      data:
        title: "Laundry: Dryer"
        content: !include ../../popup-content/laundry-dryer.yaml
  styles: |-
    ${(() => {
      const st = hass.states['sensor.dryer_current_status']?.state || 'unknown';
      const remRaw = hass.states['sensor.dryer_remaining_time']?.state;
      const totRaw = hass.states['sensor.dryer_total_time']?.state;
      const isNum = (v) => v !== undefined && v !== null && !isNaN(parseFloat(v));
      const rem = isNum(remRaw) ? parseFloat(remRaw) : NaN;
      const tot = isNum(totRaw) ? parseFloat(totRaw) : NaN;
      const progress = (!isNaN(rem) && !isNaN(tot) && tot > 0) ? Math.max(0, Math.min(1, rem / tot)) : 0;
      const s = (arr => arr.some(k => st.toLowerCase().includes(k)))(['run','running','dry','tumble','on','start','pre']) && st.toLowerCase() !== 'power_off';
      const bg = s ? 'rgba(100, 181, 246, 0.25)' : 'rgba(120, 144, 156, 0.20)';
      let css = '';
      css += `.bubble-sub-button { border: 3px solid transparent; border-radius: 16px; background: linear-gradient(${bg}), conic-gradient(#2196F3 calc(${progress} * 360deg), rgba(33,150,243,0.12) 0) !important; background-clip: padding-box, border-box; ${s ? 'animation: jiggle 0.6s ease-in-out infinite alternate;' : ''} }`;
      css += `.bubble-sub-button-icon { --mdc-icon-size: 26px; color: ${s ? '#1565C0' : '#546E7A'} !important; }`;
      css += `.bubble-sub-button-name { color: ${s ? '#0D47A1' : '#37474F'} !important; }`;
      css += `@keyframes jiggle { from { transform: translateY(0px) rotate(-1deg); } to { transform: translateY(-1px) rotate(1deg); } }`;
      return css;
    })()}
button_action:
  tap_action:
    action: none
  hold_action:
    action: none
tap_action:
  action: none
hold_action:
  action: none
